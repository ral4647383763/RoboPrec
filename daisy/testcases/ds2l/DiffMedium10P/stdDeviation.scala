import daisy.lang._
import Real._
import daisy.lang.Vector._

object stdDeviation {

	def stdDeviation(x: Vector): Real = {
require(x >= -160.06 && x <= 360.98 && x.size(1000)
	 && x.specV(Set(((0, 6),(-44.58, -8.45)), ((7, 7),(57.57, 165.91)), ((8, 9),(-135.17, 29.65)),
((11, 13),(94.41, 159.09)), ((16, 18),(-136.31, -131.72)), ((19, 28),(-1.8, 135.43)),
((29, 29),(112.49, 118.23)), ((30, 39),(-3.15, 55.25)), ((40, 44),(-90.38, 30.76)),
((47, 56),(-77.41, 271.61)), ((57, 57),(-152.71, 257.56)), ((58, 61),(74.85, 208.56)),
((62, 63),(-126.89, -84.67)), ((64, 65),(-19.5, 186.68)), ((66, 66),(262.8, 343.86)),
((67, 72),(-130.81, 267.65)), ((73, 82),(149.82, 305.06)), ((83, 87),(141.35, 153.54)),
((88, 88),(96.74, 109.62)), ((89, 89),(-159.85, -74.04)), ((90, 92),(-146.92, -128.0)),
((93, 94),(-77.1, -63.32)), ((95, 95),(-105.39, 314.99)), ((96, 97),(159.15, 182.16)),
((98, 107),(-57.28, 55.22)), ((110, 117),(109.97, 174.81)), ((122, 124),(56.3, 177.36)),
((126, 134),(104.93, 159.43)), ((135, 144),(-126.83, 166.09)), ((155, 164),(217.33, 357.89)),
((171, 178),(88.96, 120.47)), ((179, 183),(35.41, 67.45)), ((184, 185),(-118.13, 315.26)),
((187, 188),(-68.67, 181.5)), ((189, 191),(-23.85, 359.21)), ((192, 195),(-95.83, 175.5)),
((203, 212),(304.33, 321.99)), ((236, 245),(-22.87, 331.2)), ((246, 246),(-132.69, 171.25)),
((247, 255),(193.85, 197.23)), ((258, 259),(317.88, 346.33)), ((260, 260),(-6.03, 323.76)),
((261, 270),(-115.55, 305.84)), ((271, 280),(-71.6, 104.33)), ((281, 284),(278.51, 311.33)),
((285, 286),(-77.12, -54.41)), ((287, 291),(-60.05, 316.67)), ((292, 293),(42.47, 153.21)),
((294, 294),(37.65, 283.83)), ((295, 304),(320.17, 351.42)), ((305, 305),(119.4, 278.41)),
((306, 309),(85.94, 116.41)), ((310, 319),(-156.73, -146.24)), ((322, 331),(-38.23, 337.9)),
((370, 379),(251.15, 300.93)), ((390, 392),(43.96, 144.92)), ((394, 395),(-70.68, 134.43)),
((396, 405),(-142.91, -101.76)), ((414, 420),(-75.75, 164.01)), ((474, 483),(205.05, 349.21)),
((508, 517),(-143.98, -87.95)), ((518, 518),(-137.84, 175.25)), ((519, 519),(-135.73, -124.72)),
((523, 532),(236.85, 286.21)), ((533, 533),(-56.21, 337.31)), ((534, 543),(118.12, 186.0)),
((544, 544),(233.73, 298.31)), ((545, 550),(39.94, 210.53)), ((551, 551),(-54.21, -31.58)),
((552, 552),(-142.42, 334.54)), ((553, 562),(232.68, 314.67)), ((574, 575),(-114.48, 231.46)),
((579, 588),(88.54, 169.37)), ((609, 618),(-90.94, 252.59)), ((639, 639),(-6.63, 176.7)),
((640, 642),(-23.99, 15.28)), ((643, 644),(22.77, 324.56)), ((645, 654),(-134.84, 235.85)),
((661, 670),(240.74, 314.26)), ((687, 694),(88.0, 153.61)), ((701, 710),(-10.18, 228.46)),
((728, 737),(-143.78, 251.07)), ((740, 748),(-108.84, 110.16)), ((749, 757),(-134.99, 84.28)),
((758, 758),(134.9, 212.17)), ((759, 768),(139.3, 271.27)), ((777, 779),(-10.46, 67.14)),
((780, 789),(-9.83, 112.73)), ((821, 830),(-131.94, 230.99)), ((835, 839),(-110.2, 21.16)),
((842, 851),(202.17, 269.98)), ((892, 901),(148.68, 343.87)), ((902, 903),(108.35, 338.68)),
((904, 907),(-77.27, 141.1)), ((914, 917),(264.71, 328.83)), ((918, 919),(-73.68, -39.42)),
((922, 922),(239.48, 329.05)), ((924, 933),(95.4, 356.35)), ((954, 957),(-105.58, 132.38)),
((981, 990),(-110.48, 10.13))))
	)

        val n: Real = x.length()
        val y = x.fold(0.0)((acc: Real, i: Real) => acc + i)
        val avg = y / n

        val z = x.fold(0.0)((acc: Real, i: Real) => {
            acc + pow((i - avg), 2)
        })
        sqrt(z / n)
    }


}