import daisy.lang._
import Real._
import daisy.lang.Vector._

object lorentz {

	def lorentz(m:Matrix): Vector = {
require(m >= 1.0 && m <= 2.0 && m.size(31,3)
	 && m.specM(Set((Set((0, 0)),(1.03, 1.99)), (Set((0, 1)),(1.61, 1.77)),
		(Set((0, 2)),(1.34, 1.89)), (Set((1, 0)),(1.18, 1.81)),
		(Set((1, 1)),(1.67, 1.75)), (Set((1, 2)),(1.06, 1.7)),
		(Set((2, 0)),(1.35, 1.43)), (Set((2, 1)),(1.11, 1.26)),
		(Set((2, 2)),(1.05, 1.49)), (Set((3, 0)),(1.43, 1.69)),
		(Set((3, 1)),(1.33, 1.76)), (Set((3, 2)),(1.05, 1.79)),
		(Set((4, 0)),(1.7, 1.85)), (Set((4, 1)),(1.58, 1.69)),
		(Set((4, 2)),(1.1, 1.89)), (Set((5, 0)),(1.28, 1.52)),
		(Set((5, 1)),(1.04, 1.76)), (Set((5, 2)),(1.14, 1.76)),
		(Set((6, 0)),(1.05, 1.74)), (Set((6, 1)),(1.5, 1.58)),
		(Set((6, 2)),(1.0, 1.41)), (Set((7, 0)),(1.27, 1.61)),
		(Set((7, 1)),(1.7, 1.74)), (Set((7, 2)),(1.78, 1.96)),
		(Set((8, 0)),(1.04, 1.75)), (Set((8, 1)),(1.03, 1.28)),
		(Set((8, 2)),(1.36, 1.48)), (Set((9, 0)),(1.83, 1.95)),
		(Set((9, 1)),(1.56, 1.62)), (Set((9, 2)),(1.3, 1.71)),
		(Set((10, 0)),(1.16, 1.94)), (Set((10, 1)),(1.77, 1.85)),
		(Set((10, 2)),(1.0, 1.2)), (Set((11, 0)),(1.22, 1.98)),
		(Set((11, 1)),(1.41, 1.82)), (Set((11, 2)),(1.43, 1.71)),
		(Set((12, 0)),(1.66, 1.77)), (Set((12, 1)),(1.51, 1.69)),
		(Set((12, 2)),(1.05, 1.97)), (Set((13, 0)),(1.65, 1.74)),
		(Set((13, 1)),(1.62, 1.69)), (Set((13, 2)),(1.58, 1.93)),
		(Set((14, 0)),(1.2, 1.66)), (Set((14, 1)),(1.42, 1.59)),
		(Set((14, 2)),(1.18, 1.88)), (Set((15, 0)),(1.05, 1.09)),
		(Set((15, 1)),(1.15, 1.8)), (Set((15, 2)),(1.15, 1.36)),
		(Set((16, 0)),(1.76, 1.79)), (Set((16, 1)),(1.77, 1.97)),
		(Set((16, 2)),(1.3, 1.32)), (Set((17, 0)),(1.41, 1.51)),
		(Set((17, 1)),(1.47, 1.58)), (Set((17, 2)),(1.11, 1.45)),
		(Set((18, 0)),(1.21, 1.85)), (Set((18, 1)),(1.62, 2.0)),
		(Set((18, 2)),(1.03, 1.75)), (Set((19, 0)),(1.09, 1.13)),
		(Set((19, 1)),(1.35, 1.55)), (Set((19, 2)),(1.03, 1.31)),
		(Set((20, 0)),(1.33, 1.98)), (Set((20, 1)),(1.64, 1.89)),
		(Set((20, 2)),(1.11, 1.47)), (Set((21, 0)),(1.01, 1.23)),
		(Set((21, 1)),(1.04, 1.52)), (Set((21, 2)),(1.26, 1.38)),
		(Set((22, 0)),(1.24, 1.57)), (Set((22, 1)),(1.38, 1.64)),
		(Set((22, 2)),(1.07, 1.42)), (Set((23, 0)),(1.37, 1.99)),
		(Set((23, 1)),(1.22, 1.64)), (Set((23, 2)),(1.28, 1.37)),
		(Set((24, 0)),(1.78, 1.93)), (Set((24, 1)),(1.0, 1.65)),
		(Set((24, 2)),(1.23, 1.76)), (Set((25, 0)),(1.76, 1.95)),
		(Set((25, 1)),(1.26, 1.83)), (Set((25, 2)),(1.6, 1.75)),
		(Set((26, 0)),(1.0, 1.4)), (Set((26, 1)),(1.59, 1.65)),
		(Set((26, 2)),(1.1, 1.82)), (Set((27, 0)),(1.19, 1.37)),
		(Set((27, 1)),(1.54, 1.89)), (Set((27, 2)),(1.35, 1.87)),
		(Set((28, 0)),(1.09, 1.66)), (Set((28, 1)),(1.4, 1.96)),
		(Set((28, 2)),(1.13, 1.53)), (Set((29, 0)),(1.02, 1.46)),
		(Set((29, 1)),(1.08, 1.22)), (Set((29, 2)),(1.24, 1.96)),
		(Set((30, 0)),(1.22, 1.7)), (Set((30, 1)),(1.58, 1.94)),
		(Set((30, 2)),(1.73, 1.76))))
	)

        val init: Vector = m.row(0)
        m.fold(init)((acc, v) => {
            val x:Real = acc.at(0)
            val y:Real = acc.at(1)
            val z:Real = acc.at(2)
            val tmpx:Real = x + 10.0*(y - x)*0.005
            val tmpy:Real = y + (28.0*x - y - x*z)*0.005
            val tmpz:Real = z + (x*y - 2.666667*z)*0.005
            Vector(List(tmpx,tmpy,tmpz))
        })
    }


}