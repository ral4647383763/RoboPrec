import daisy.lang._
import Real._
import daisy.lang.Vector._

object lorentz {

	def lorentz(m:Matrix): Vector = {
require(m >= 1.0 && m <= 2.0 && m.size(41,3)
	 && m.specM(Set((Set((0, 0)),(1.42, 1.85)), (Set((0, 1)),(1.14, 1.99)),
		(Set((0, 2)),(1.0, 1.65)), (Set((1, 0)),(1.38, 1.63)),
		(Set((1, 1)),(1.31, 1.89)), (Set((1, 2)),(1.64, 1.73)),
		(Set((2, 0)),(1.3, 1.57)), (Set((2, 1)),(1.1, 1.16)),
		(Set((2, 2)),(1.32, 1.84)), (Set((3, 0)),(1.04, 1.38)),
		(Set((3, 1)),(1.26, 1.4)), (Set((3, 2)),(1.01, 1.02)),
		(Set((4, 0)),(1.07, 1.55)), (Set((4, 1)),(1.01, 1.69)),
		(Set((4, 2)),(1.2, 1.48)), (Set((5, 0)),(1.51, 1.89)),
		(Set((5, 1)),(1.25, 1.71)), (Set((5, 2)),(1.5, 1.58)),
		(Set((6, 0)),(1.1, 1.18)), (Set((6, 1)),(1.3, 1.34)),
		(Set((6, 2)),(1.26, 1.45)), (Set((7, 0)),(1.8, 1.9)),
		(Set((7, 1)),(1.22, 1.71)), (Set((7, 2)),(1.01, 1.51)),
		(Set((8, 0)),(1.22, 1.85)), (Set((8, 1)),(1.08, 1.48)),
		(Set((8, 2)),(1.28, 1.87)), (Set((9, 0)),(1.05, 1.72)),
		(Set((9, 1)),(1.51, 1.71)), (Set((9, 2)),(1.01, 1.19)),
		(Set((10, 0)),(1.33, 1.59)), (Set((10, 1)),(1.7, 1.76)),
		(Set((10, 2)),(1.24, 1.32)), (Set((11, 0)),(1.65, 1.74)),
		(Set((11, 1)),(1.57, 1.91)), (Set((11, 2)),(1.16, 1.64)),
		(Set((12, 0)),(1.41, 1.96)), (Set((12, 1)),(1.38, 1.61)),
		(Set((12, 2)),(1.12, 1.61)), (Set((13, 0)),(1.23, 1.9)),
		(Set((13, 1)),(1.45, 1.89)), (Set((13, 2)),(1.38, 1.71)),
		(Set((14, 0)),(1.43, 1.75)), (Set((14, 1)),(1.01, 1.07)),
		(Set((14, 2)),(1.02, 1.88)), (Set((15, 0)),(1.21, 1.83)),
		(Set((15, 1)),(1.52, 1.81)), (Set((15, 2)),(1.05, 1.53)),
		(Set((16, 0)),(1.14, 1.59)), (Set((16, 1)),(1.19, 1.65)),
		(Set((16, 2)),(1.0, 1.97)), (Set((17, 0)),(1.08, 1.61)),
		(Set((17, 1)),(1.09, 1.82)), (Set((17, 2)),(1.11, 1.41)),
		(Set((18, 0)),(1.11, 1.23)), (Set((18, 1)),(1.54, 1.97)),
		(Set((18, 2)),(1.07, 1.76)), (Set((19, 0)),(1.1, 1.88)),
		(Set((19, 1)),(1.21, 1.4)), (Set((19, 2)),(1.41, 1.54)),
		(Set((20, 0)),(1.01, 1.32)), (Set((20, 1)),(1.73, 1.93)),
		(Set((20, 2)),(1.21, 1.46)), (Set((21, 0)),(1.1, 1.93)),
		(Set((21, 1)),(1.34, 1.85)), (Set((21, 2)),(1.27, 1.59)),
		(Set((22, 0)),(1.7, 1.79)), (Set((22, 1)),(1.09, 1.45)),
		(Set((22, 2)),(1.59, 1.81)), (Set((23, 0)),(1.33, 1.79)),
		(Set((23, 1)),(1.54, 1.95)), (Set((23, 2)),(1.01, 1.58)),
		(Set((24, 0)),(1.34, 1.49)), (Set((24, 1)),(1.18, 1.9)),
		(Set((24, 2)),(1.74, 1.75)), (Set((25, 0)),(1.08, 1.29)),
		(Set((25, 1)),(1.3, 1.81)), (Set((25, 2)),(1.32, 1.68)),
		(Set((26, 0)),(1.7, 1.89)), (Set((26, 1)),(1.61, 1.68)),
		(Set((26, 2)),(1.42, 1.59)), (Set((27, 0)),(1.8, 1.95)),
		(Set((27, 1)),(1.15, 1.98)), (Set((27, 2)),(1.26, 1.6)),
		(Set((28, 0)),(1.48, 1.76)), (Set((28, 1)),(1.07, 1.88)),
		(Set((28, 2)),(1.49, 1.55)), (Set((29, 0)),(1.82, 1.95)),
		(Set((29, 1)),(1.45, 1.68)), (Set((29, 2)),(1.71, 1.75)),
		(Set((30, 0)),(1.09, 1.52)), (Set((30, 1)),(1.32, 2.0)),
		(Set((30, 2)),(1.4, 1.96)), (Set((31, 0)),(1.02, 1.07)),
		(Set((31, 1)),(1.36, 1.79)), (Set((31, 2)),(1.17, 1.78)),
		(Set((32, 0)),(1.23, 1.74)), (Set((32, 1)),(1.26, 1.51)),
		(Set((32, 2)),(1.02, 1.79)), (Set((33, 0)),(1.72, 1.81)),
		(Set((33, 1)),(1.66, 1.84)), (Set((33, 2)),(1.02, 2.0)),
		(Set((34, 0)),(1.06, 1.9)), (Set((34, 1)),(1.17, 1.74)),
		(Set((34, 2)),(1.0, 1.14)), (Set((35, 0)),(1.16, 1.4)),
		(Set((35, 1)),(1.08, 1.21)), (Set((35, 2)),(1.44, 1.49)),
		(Set((36, 0)),(1.15, 1.92)), (Set((36, 1)),(1.09, 1.28)),
		(Set((36, 2)),(1.12, 1.71)), (Set((37, 0)),(1.93, 1.99)),
		(Set((37, 1)),(1.08, 1.16)), (Set((37, 2)),(1.33, 1.87)),
		(Set((38, 0)),(1.21, 1.73)), (Set((38, 1)),(1.21, 1.71)),
		(Set((38, 2)),(1.11, 1.77)), (Set((39, 0)),(1.35, 1.64)),
		(Set((39, 1)),(1.67, 1.88)), (Set((39, 2)),(1.65, 1.7)),
		(Set((40, 0)),(1.41, 1.49)), (Set((40, 1)),(1.14, 1.6)),
		(Set((40, 2)),(1.06, 1.48))))
	)

        val init: Vector = m.row(0)
        m.fold(init)((acc, v) => {
            val x:Real = acc.at(0)
            val y:Real = acc.at(1)
            val z:Real = acc.at(2)
            val tmpx:Real = x + 10.0*(y - x)*0.005
            val tmpy:Real = y + (28.0*x - y - x*z)*0.005
            val tmpz:Real = z + (x*y - 2.666667*z)*0.005
            Vector(List(tmpx,tmpy,tmpz))
        })
    }


}